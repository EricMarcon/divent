<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Probabilities of Species — probabilities • divent</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Probabilities of Species — probabilities"><meta name="description" content="Estimate actual probabilities of species from a sample"><meta property="og:description" content="Estimate actual probabilities of species from a sample"><meta property="og:image" content="https://ericmarcon.github.io/divent/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">divent</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.4-99.9016</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/divent.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/arguments.html">Common Arguments of divent Functions</a></li>
    <li><a class="dropdown-item" href="../articles/extrapolation.html">Asymptotic Estimation, Interpolation and Extrapolation </a></li>
    <li><a class="dropdown-item" href="../articles/phylogenies.html">Phylogenies in divent</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EricMarcon/divent/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Probabilities of Species</h1>
      <small class="dont-index">Source: <a href="https://github.com/EricMarcon/divent/blob/master/R/probabilities.R" class="external-link"><code>R/probabilities.R</code></a></small>
      <div class="d-none name"><code>probabilities.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimate actual probabilities of species from a sample</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">probabilities</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'numeric'</span></span>
<span><span class="fu">probabilities</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  estimator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"naive"</span>, <span class="st">"Chao2013"</span>, <span class="st">"Chao2015"</span>, <span class="st">"ChaoShen"</span><span class="op">)</span>,</span>
<span>  unveiling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"uniform"</span>, <span class="st">"geometric"</span><span class="op">)</span>,</span>
<span>  richness_estimator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"jackknife"</span>, <span class="st">"iChao1"</span>, <span class="st">"Chao1"</span>, <span class="st">"rarefy"</span>, <span class="st">"naive"</span><span class="op">)</span>,</span>
<span>  jack_alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  jack_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  coverage_estimator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ZhangHuang"</span>, <span class="st">"Chao"</span>, <span class="st">"Turing"</span>, <span class="st">"Good"</span><span class="op">)</span>,</span>
<span>  q <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  as_numeric <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  check_arguments <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'abundances'</span></span>
<span><span class="fu">probabilities</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  estimator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"naive"</span>, <span class="st">"Chao2013"</span>, <span class="st">"Chao2015"</span>, <span class="st">"ChaoShen"</span><span class="op">)</span>,</span>
<span>  unveiling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"uniform"</span>, <span class="st">"geometric"</span><span class="op">)</span>,</span>
<span>  richness_estimator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"jackknife"</span>, <span class="st">"iChao1"</span>, <span class="st">"Chao1"</span>, <span class="st">"rarefy"</span>, <span class="st">"naive"</span><span class="op">)</span>,</span>
<span>  jack_alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  jack_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  coverage_estimator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ZhangHuang"</span>, <span class="st">"Chao"</span>, <span class="st">"Turing"</span>, <span class="st">"Good"</span><span class="op">)</span>,</span>
<span>  q <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  check_arguments <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object. It may be:</p><ul><li><p>a numeric vector containing abundances. It may be named to track species names.</p></li>
<li><p>an object of class <a href="species_distribution.html">species_distribution</a>.</p></li>
</ul></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Unused.</p></dd>


<dt id="arg-estimator">estimator<a class="anchor" aria-label="anchor" href="#arg-estimator"></a></dt>
<dd><p>One of the estimators of a probability distribution:
"naive" (the default value), or "Chao2013", "Chao2015", "ChaoShen" to estimate
the probabilities of the observed species in the asymptotic distribution.</p></dd>


<dt id="arg-unveiling">unveiling<a class="anchor" aria-label="anchor" href="#arg-unveiling"></a></dt>
<dd><p>One of the possible unveiling methods to estimate the probabilities
of the unobserved species: "none" (default, no species is added), "uniform"
(all unobserved species have the same probability) or "geometric" (the
unobserved species distribution is geometric).</p></dd>


<dt id="arg-richness-estimator">richness_estimator<a class="anchor" aria-label="anchor" href="#arg-richness-estimator"></a></dt>
<dd><p>An estimator of richness to evaluate the total number
of species. "jackknife" is the default value.
An alternative is "rarefy" to estimate the number of species such that the
entropy of the asymptotic distribution rarefied to the observed sample size equals
the actual entropy of the data.</p></dd>


<dt id="arg-jack-alpha">jack_alpha<a class="anchor" aria-label="anchor" href="#arg-jack-alpha"></a></dt>
<dd><p>the risk level, 5% by default, used to optimize the jackknife order.</p></dd>


<dt id="arg-jack-max">jack_max<a class="anchor" aria-label="anchor" href="#arg-jack-max"></a></dt>
<dd><p>the highest jackknife order allowed. Default is 10.</p></dd>


<dt id="arg-coverage-estimator">coverage_estimator<a class="anchor" aria-label="anchor" href="#arg-coverage-estimator"></a></dt>
<dd><p>an estimator of sample coverage used by <a href="coverage.html">coverage</a>.</p></dd>


<dt id="arg-q">q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>The order of diversity. Default is 0 for richness.
Used only to estimate asymptotic probability distributions when argument
<code>richness_estimator</code> is "rarefy". Then, the number of unobserved species is
fitted so that the entropy of order q of the asymptotic probability distribution
at the observed sample size equals the actual entropy of the data.</p></dd>


<dt id="arg-as-numeric">as_numeric<a class="anchor" aria-label="anchor" href="#arg-as-numeric"></a></dt>
<dd><p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p></dd>


<dt id="arg-check-arguments">check_arguments<a class="anchor" aria-label="anchor" href="#arg-check-arguments"></a></dt>
<dd><p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class "probabilities", which is a <a href="species_distribution.html">species_distribution</a>
or a numeric vector with argument <code>as_numeric = TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>probabilities()</code> estimates a probability distribution from a sample.
If the <code>estimator</code> is not "naive", the observed abundance distribution is used
to estimate the actual probability distribution.
The list of species is changed:
zero-abundance species are cleared, and some unobserved species are added.
First, observed species probabilities are estimated following
Chao and Shen (2003)
, i.e. input probabilities are multiplied by
the sample coverage, or according to more sophisticated models:
Chao et al. (2013)
, a single-parameter model, or
Chao and Jost (2015)
, a two-parameter model.
The total probability of observed species equals the sample coverage.
Then, the distribution of unobserved species can be unveiled: their number
is estimated according to the <code>richness_estimator</code>.
The coverage deficit (1 minus the sample coverage) is shared by the unobserved
species equally (<code>unveiling</code> = "uniform", (Chao et al. 2013)
) or
according to a geometric distribution (<code>unveiling</code> = "geometric", (Chao and Jost 2015)
).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chao A, Jost L (2015).
“Estimating Diversity and Entropy Profiles via Discovery Rates of New Species.”
<em>Methods in Ecology and Evolution</em>, <b>6</b>(8), 873–882.
<a href="https://doi.org/10.1111/2041-210X.12349" class="external-link">doi:10.1111/2041-210X.12349</a>
.<br><br> Chao A, Shen T (2003).
“Nonparametric Estimation of Shannon's Index of Diversity When There Are Unseen Species in Sample.”
<em>Environmental and Ecological Statistics</em>, <b>10</b>(4), 429–443.
<a href="https://doi.org/10.1023/A%3A1026096204727" class="external-link">doi:10.1023/A:1026096204727</a>
.<br><br> Chao A, Wang Y, Jost L (2013).
“Entropy and the Species Accumulation Curve: A Novel Entropy Estimator via Discovery Rates of New Species.”
<em>Methods in Ecology and Evolution</em>, <b>4</b>(11), 1091–1100.
<a href="https://doi.org/10.1111/2041-210x.12108" class="external-link">doi:10.1111/2041-210x.12108</a>
.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Just transform abundances into probabilities</span></span></span>
<span class="r-in"><span><span class="fu">probabilities</span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 337</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   site      weight Abarema_jupunba Abarema_mataybifolia Amaioua_guianensis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> subplot_1      1         0.002<span style="text-decoration: underline;">12</span>              0.002<span style="text-decoration: underline;">12</span>            0.001<span style="text-decoration: underline;">06</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> subplot_2      1         0.002<span style="text-decoration: underline;">29</span>              0                  0.001<span style="text-decoration: underline;">15</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> subplot_3      1         0.002<span style="text-decoration: underline;">15</span>              0.002<span style="text-decoration: underline;">15</span>            0      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> subplot_4      1         0.005<span style="text-decoration: underline;">01</span>              0                  0      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 332 more variables: Amanoa_congesta &lt;dbl&gt;, Amanoa_guianensis &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Ambelania_acida &lt;dbl&gt;, Amphirrhox_longifolia &lt;dbl&gt;, Andira_coriacea &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Apeiba_glabra &lt;dbl&gt;, Aspidosperma_album &lt;dbl&gt;, Aspidosperma_cruentum &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Aspidosperma_excelsum &lt;dbl&gt;, Bocoa_prouacensis &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Brosimum_guianense &lt;dbl&gt;, Brosimum_rubescens &lt;dbl&gt;, Brosimum_utile &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Carapa_surinamensis &lt;dbl&gt;, Caryocar_glabrum &lt;dbl&gt;, Casearia_decandra &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Casearia_javitensis &lt;dbl&gt;, Catostemma_fragrans &lt;dbl&gt;, …</span></span>
<span class="r-in"><span><span class="co"># Estimate the distribution of probabilities from observed abundances (unveiled probabilities)</span></span></span>
<span class="r-in"><span><span class="va">prob_unv</span> <span class="op">&lt;-</span> <span class="fu">probabilities</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">paracou_6_abd</span>,</span></span>
<span class="r-in"><span>  estimator <span class="op">=</span> <span class="st">"Chao2015"</span>,</span></span>
<span class="r-in"><span>  unveiling <span class="op">=</span> <span class="st">"geometric"</span>,</span></span>
<span class="r-in"><span>  richness_estimator <span class="op">=</span> <span class="st">"jackknife"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Estimate entropy from the unveiled probabilities</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ent_shannon.html">ent_shannon</a></span><span class="op">(</span><span class="va">prob_unv</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   site      weight estimator order entropy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> subplot_1      1 naive         1    4.57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> subplot_2      1 naive         1    4.73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> subplot_3      1 naive         1    4.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> subplot_4      1 naive         1    4.55</span>
<span class="r-in"><span><span class="co"># Identical to</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ent_shannon.html">ent_shannon</a></span><span class="op">(</span><span class="va">paracou_6_abd</span>, estimator <span class="op">=</span> <span class="st">"UnveilJ"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   site      weight estimator order entropy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> subplot_1   1.56 UnveilJ       1    4.57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> subplot_2   1.56 UnveilJ       1    4.73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> subplot_3   1.56 UnveilJ       1    4.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> subplot_4   1.56 UnveilJ       1    4.55</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Marcon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

