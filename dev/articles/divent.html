<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>divent • divent</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="divent">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">divent</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.4-99.9005</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/divent.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/arguments.html">Common Arguments of divent Functions</a></li>
    <li><a class="dropdown-item" href="../articles/extrapolation.html">Asymptotic Estimation, Interpolation and Extrapolation </a></li>
    <li><a class="dropdown-item" href="../articles/phylogenies.html">Phylogenies in divent</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EricMarcon/divent/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>divent</h1>
            <h3 data-toc-skip class="subtitle">Measures of Diversity
based on Entropy</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EricMarcon/divent/blob/master/vignettes/divent.Rmd" class="external-link"><code>vignettes/divent.Rmd</code></a></small>
      <div class="d-none name"><code>divent.Rmd</code></div>
    </div>

    
    
<p><em>divent</em> is a package for <em>R</em> designed to estimate
diversity based on HCDT entropy or similarity-based entropy. It is a
reboot of the <em>entropart</em> package, following the tidyverse
manifest and easier to use. This is a short introduction to its use.</p>
<p>The package allows estimating biodiversity according to the framework
based on HCDT entropy, the correction of its estimation-bias <span class="citation">(Grassberger 1988; Chao and Shen 2003; Chao and Jost
2015)</span> and its transformation into equivalent numbers of species
<span class="citation">(Hill 1973; Jost 2006; Marcon et al.
2014)</span>. Estimation of diversity at arbitrary levels of sampling,
requiring interpolation or extrapolation <span class="citation">(Chao et
al. 2014)</span> is available.</p>
<p>Phylogenetic or functional diversity <span class="citation">(Marcon
and Hérault 2015)</span> can be estimated, considering phyloentropy as
the average species-neutral diversity over slices of a phylogenetic or
functional tree <span class="citation">(Pavoine and Bonsall
2009)</span>.</p>
<p>Similarity-based diversity <span class="citation">(Leinster and
Cobbold 2012)</span> can be used to estimate <span class="citation">(Marcon, Zhang, and Hérault 2014)</span> functional
diversity from a similarity or dissimilarity matrix between species
without requiring building a dendrogram and thus preserving the topology
of species <span class="citation">(Pavoine, Ollier, and Dufour 2005;
Podani and Schmera 2007)</span>.</p>
<p>The classical diversity estimators (Shannon and Simpson entropy) can
be found in many R packages. Bias correction is rarely available except
in the <em>EntropyEstimation</em> <span class="citation">(Cao and
Grabchak 2014)</span> package which provides the Zhang and Grabchak’s
estimators of entropy and diversity and their asymptotic variance (not
included in <em>divent</em>).</p>
<div class="section level2">
<h2 id="estimating-the-diversity-of-a-community">Estimating the diversity of a community<a class="anchor" aria-label="anchor" href="#estimating-the-diversity-of-a-community"></a>
</h2>
<div class="section level3">
<h3 id="community-data">Community data<a class="anchor" aria-label="anchor" href="#community-data"></a>
</h3>
<p>Community data is:</p>
<ul>
<li>either a numeric vector containing abundances of species (the number
of individual of each species) or their probabilities (the proportion of
individuals of each species, summing to 1). This format is convenient
when a single community is considered.</li>
<li>or a dataframe whose rows are communities and column are species.
Its values are either abundances or probabilities. Special columns
contain the site names, and their weights (e.g. their area or number of
individuals).</li>
</ul>
<p>Example data is provided in the dataset <code>paracou_6_abd</code>.
Let’s get the abundances of tree species in the 6.25-ha tropical forest
plot #6 from Paracou forest station in French Guiana. It is divided into
4 equally-sized subplots:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ericmarcon.github.io/divent/">"divent"</a></span><span class="op">)</span></span>
<span><span class="va">paracou_6_abd</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 337</span></span></span>
<span><span class="co">##   site      weight Abarema_jupunba Abarema_mataybifolia Amaioua_guianensis</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56               2                    2                  1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> subplot_2   1.56               2                    0                  1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> subplot_3   1.56               2                    2                  0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_4   1.56               4                    0                  0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 332 more variables: Amanoa_congesta &lt;int&gt;, Amanoa_guianensis &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Ambelania_acida &lt;int&gt;, Amphirrhox_longifolia &lt;int&gt;, Andira_coriacea &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Apeiba_glabra &lt;int&gt;, Aspidosperma_album &lt;int&gt;, Aspidosperma_cruentum &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Aspidosperma_excelsum &lt;int&gt;, Bocoa_prouacensis &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Brosimum_guianense &lt;int&gt;, Brosimum_rubescens &lt;int&gt;, Brosimum_utile &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Carapa_surinamensis &lt;int&gt;, Caryocar_glabrum &lt;int&gt;, Casearia_decandra &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Casearia_javitensis &lt;int&gt;, Catostemma_fragrans &lt;int&gt;, …</span></span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of individuals in each community</span></span>
<span><span class="fu"><a href="../reference/abd_species.html">abd_sum</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">##   site      weight abundance</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56       942</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> subplot_2   1.56       872</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> subplot_3   1.56       929</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_4   1.56       798</span></span></code></pre>
<p>The data in <code>paracou_6_abd</code> is an object of class
<code>abundances</code>, i.e. a tibble with species as columns and sites
as rows. It can be manipulated as any dataframe and plotted as a
rank-abundance curve:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="divent_files/figure-html/plot_paracou6-1.png" width="700"></p>
<p>The <code>rcommunity</code> function allows drawing random
communities, e.g. a log-normal one <span class="citation">(Preston
1948)</span>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rcommunity.html">rcommunity</a></span><span class="op">(</span><span class="fl">1</span>, size <span class="op">=</span> <span class="fl">10000</span>, distribution <span class="op">=</span> <span class="st">"lnorm"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">rc</span>, fit_rac <span class="op">=</span> <span class="cn">TRUE</span>, distribution <span class="op">=</span> <span class="st">"lnorm"</span><span class="op">)</span></span></code></pre></div>
<p><img src="divent_files/figure-html/rcommunity-1.png" width="700"></p>
<p>The Whittaker plot (rank-abundance curve) of a random log-normal
distribution of 10000 individuals simulated with default parameter
(<span class="math inline">\(\sigma = 1\)</span>) is produced.</p>
</div>
<div class="section level3">
<h3 id="diversity-estimation">Diversity estimation<a class="anchor" aria-label="anchor" href="#diversity-estimation"></a>
</h3>
<p>The classical indices of diversity are richness (the number of
species), Shannon’s and Simpson’s entropies:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/div_richness.html">div_richness</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   site      weight estimator   order diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 Jackknife 3     0       355</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> subplot_2   1.56 Jackknife 2     0       348</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> subplot_3   1.56 Jackknife 2     0       315</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_4   1.56 Jackknife 2     0       296</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ent_shannon.html">ent_shannon</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   site      weight estimator order entropy</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 UnveilJ       1    4.57</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> subplot_2   1.56 UnveilJ       1    4.73</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> subplot_3   1.56 UnveilJ       1    4.65</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_4   1.56 UnveilJ       1    4.55</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ent_simpson.html">ent_simpson</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   site      weight estimator order entropy</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 Lande         2   0.976</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> subplot_2   1.56 Lande         2   0.978</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> subplot_3   1.56 Lande         2   0.980</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_4   1.56 Lande         2   0.972</span></span></code></pre>
<p>When applied to probabilities (created with
<code>as_probaVector</code> in the following example), no
estimation-bias correction is applied: this means that indices are just
calculated by applying their definition function to the probabilities
(that is the naive, or plugin estimator).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paracou_6_abd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/species_distribution.html">as_probabilities</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/ent_shannon.html">ent_shannon</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   site      weight estimator order entropy</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 naive         1    4.34</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> subplot_2   1.56 naive         1    4.48</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> subplot_3   1.56 naive         1    4.45</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_4   1.56 naive         1    4.32</span></span></code></pre>
<p>When abundances are available, many estimators can be used <span class="citation">(Marcon 2015)</span> to address unobserved species and
the non-linearity of the indices:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ent_shannon.html">ent_shannon</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   site      weight estimator order entropy</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 UnveilJ       1    4.57</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> subplot_2   1.56 UnveilJ       1    4.73</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> subplot_3   1.56 UnveilJ       1    4.65</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_4   1.56 UnveilJ       1    4.55</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ent_shannon.html">ent_shannon</a></span><span class="op">(</span><span class="va">paracou_6_abd</span>, estimator <span class="op">=</span> <span class="st">"ChaoJost"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   site      weight estimator order entropy</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 ChaoJost      1    4.51</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> subplot_2   1.56 ChaoJost      1    4.68</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> subplot_3   1.56 ChaoJost      1    4.62</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_4   1.56 ChaoJost      1    4.50</span></span></code></pre>
<p>The best available estimator is chosen by default: its name is
returned.</p>
<p>Those indices are special cases of the Tsallis entropy <span class="citation">(1988)</span> or order <span class="math inline">\(q\)</span> (respectively <span class="math inline">\(q=0,1,2\)</span> for richness, Shannon,
Simpson):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ent_tsallis.html">ent_tsallis</a></span><span class="op">(</span><span class="va">paracou_6_abd</span>, q <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   site      weight estimator order entropy</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 UnveilJ       1    4.57</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> subplot_2   1.56 UnveilJ       1    4.73</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> subplot_3   1.56 UnveilJ       1    4.65</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_4   1.56 UnveilJ       1    4.55</span></span></code></pre>
<p>Entropy should be converted to its effective number of species,
i.e. the number of species with equal probabilities that would yield the
observed entropy, called <span class="citation">Hill (1973)</span>
numbers or simply diversity <span class="citation">(Jost
2006)</span>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">paracou_6_abd</span>, q <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   site      weight estimator order diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 UnveilJ       1      96.3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> subplot_2   1.56 UnveilJ       1     113. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> subplot_3   1.56 UnveilJ       1     105. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_4   1.56 UnveilJ       1      94.6</span></span></code></pre>
<p>Diversity is the deformed exponential of order <span class="math inline">\(q\)</span> of entropy, and entropy is the deformed
logarithm of of order <span class="math inline">\(q\)</span> of
diversity:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">paracou_6_abd</span>, q <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">diversity</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 42.28417 44.58777 48.83999 36.01687</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ln_q.html">ln_q</a></span><span class="op">(</span><span class="va">d2</span>, q <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9763505 0.9775723 0.9795250 0.9722352</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">e2</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/ent_tsallis.html">ent_tsallis</a></span><span class="op">(</span><span class="va">paracou_6_abd</span>, q <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">entropy</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9763505 0.9775723 0.9795250 0.9722352</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/exp_q.html">exp_q</a></span><span class="op">(</span><span class="va">e2</span>, q <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 42.28417 44.58777 48.83999 36.01687</span></span></code></pre>
<p>If an ultrametric dendrogram describing species phylogeny (here, a
mere taxonomy with family, genus and species) is available, phylogenetic
entropy and diversity <span class="citation">(Marcon and Hérault
2015)</span> can be calculated:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/div_phylo.html">div_phylo</a></span><span class="op">(</span><span class="va">paracou_6_abd</span>, tree <span class="op">=</span> <span class="va">paracou_6_taxo</span>, q <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">##   site      weight estimator diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 UnveilJ        41.0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> subplot_2   1.56 UnveilJ        52.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> subplot_3   1.56 UnveilJ        46.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_4   1.56 UnveilJ        43.2</span></span></code></pre>
<p>Recall that all those functions can be applied to a numeric vector
containing abundances, without having to build an object of class
<code>abundances</code>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Richness of a community of 100 species, each of them with 10 individuals</span></span>
<span><span class="fu"><a href="../reference/div_richness.html">div_richness</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   estimator   order diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Jackknife 0     0       100</span></span></code></pre>
<p>With a Euclidian distance matrix between species, similarity-based
diversity <span class="citation">(Leinster and Cobbold 2012; Marcon,
Zhang, and Hérault 2014)</span> is available:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Similarity is computed from the functional distance matrix of Paracou species</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fun_similarity.html">fun_similarity</a></span><span class="op">(</span><span class="va">paracou_6_fundist</span><span class="op">)</span></span>
<span><span class="co"># Calculate diversity of order 2</span></span>
<span><span class="fu"><a href="../reference/div_similarity.html">div_similarity</a></span><span class="op">(</span><span class="va">paracou_6_abd</span>, similarities <span class="op">=</span> <span class="va">Z</span>, q <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   site      weight estimator order diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 UnveilJ       2      1.31</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> subplot_2   1.56 UnveilJ       2      1.33</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> subplot_3   1.56 UnveilJ       2      1.32</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_4   1.56 UnveilJ       2      1.30</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="diversity-profiles">Diversity profiles<a class="anchor" aria-label="anchor" href="#diversity-profiles"></a>
</h3>
<p>Diversity can be plotted against its order to provide a diversity
profile. Order 0 corresponds to richness, 1 to Shannon’s and 2 to
Simpson’s diversities:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/profile_hill.html">profile_hill</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">autoplot</span></span></code></pre></div>
<p><img src="divent_files/figure-html/div_profile-1.png" width="700"></p>
<p>Profiles of phylogenetic diversity and similarity-based diversity are
obtained the same way.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/profile_phylo.html">profile_phylo</a></span><span class="op">(</span><span class="va">paracou_6_abd</span>, tree <span class="op">=</span> <span class="va">paracou_6_taxo</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">autoplot</span></span></code></pre></div>
<p><img src="divent_files/figure-html/PDiversityProfile-1.png" width="700"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Similarity matrix</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fun_similarity.html">fun_similarity</a></span><span class="op">(</span><span class="va">paracou_6_fundist</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/profile_similarity.html">profile_similarity</a></span><span class="op">(</span><span class="va">paracou_6_abd</span>, similarities <span class="op">=</span> <span class="va">Z</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">autoplot</span></span></code></pre></div>
<p><img src="divent_files/figure-html/PDiversityProfile-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="diversity-accumulation">Diversity accumulation<a class="anchor" aria-label="anchor" href="#diversity-accumulation"></a>
</h3>
<p>Diversity can be interpolated or extrapolated to arbitrary sampling
levels.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate the diversity of 1000 individuals</span></span>
<span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">paracou_6_abd</span>, q <span class="op">=</span> <span class="fl">1</span>, level <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 6</span></span></span>
<span><span class="co">##   site      weight estimator order level diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 Chao2015      1  <span style="text-decoration: underline;">1</span>000      78.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> subplot_2   1.56 Chao2015      1  <span style="text-decoration: underline;">1</span>000      91.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> subplot_3   1.56 Chao2015      1  <span style="text-decoration: underline;">1</span>000      87.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_4   1.56 Chao2015      1  <span style="text-decoration: underline;">1</span>000      78.8</span></span></code></pre>
<p>The sampling level can be a sample coverage, that is converted to the
equivalent number of individuals.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate the diversity at 80% coverage</span></span>
<span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">paracou_6_abd</span>, q <span class="op">=</span> <span class="fl">1</span>, level <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 6</span></span></span>
<span><span class="co">##   site      weight estimator     order level diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 Interpolation     1   304      60.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> subplot_2   1.56 Interpolation     1   347      71.4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> subplot_3   1.56 Interpolation     1   333      68.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_4   1.56 Interpolation     1   303      60.5</span></span></code></pre>
<p>Diversity accumulation curves are available.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accum_hill.html">accum_hill</a></span><span class="op">(</span></span>
<span>  <span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, </span>
<span>  q <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,</span>
<span>  n_simulations <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="divent_files/figure-html/accum_hill-1.png" width="700"></p>
<p>Phylogenetic diversity can be addressed the same way. Confidence
intervals of the estimation can be computed, taking into account
sampling variability.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accum_div_phylo.html">accum_div_phylo</a></span><span class="op">(</span></span>
<span>  <span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>,</span>
<span>  tree <span class="op">=</span> <span class="va">paracou_6_taxo</span>,</span>
<span>  q <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2000</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="divent_files/figure-html/accum_div_phylo-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="estimating-the-diversity-of-a-meta-community">Estimating the diversity of a meta-community<a class="anchor" aria-label="anchor" href="#estimating-the-diversity-of-a-meta-community"></a>
</h2>
<div class="section level3">
<h3 id="meta-community-data">Meta-community data<a class="anchor" aria-label="anchor" href="#meta-community-data"></a>
</h3>
<p>A metacommunity is the assemblage several communities.</p>
<p>The set of communities is described by the abundances of their
species and their weight.</p>
<p>Species probabilities in the meta-community are by definition the
weighted average of their probabilities in the communities. Abundances
are calculated so that the total abundance of the metacommunity is the
sum of all abundances of communities. If weights are equal, then the
abundances of the metacommunity are simply the sum of those of the
communities. If they are not, the abundances of the metacommunity are
generally not integer values, which complicates the estimation of
diversity.</p>
<p>Example:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Abundances of three communities with four species</span></span>
<span><span class="op">(</span><span class="va">abd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">10</span>,  <span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">10</span>, </span>
<span>    <span class="fl">20</span>, <span class="fl">15</span>, <span class="fl">10</span>, <span class="fl">35</span>, </span>
<span>     <span class="fl">0</span>, <span class="fl">10</span>,  <span class="fl">5</span>,  <span class="fl">2</span></span>
<span>  <span class="op">)</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">## [1,]   10   10   10   10</span></span>
<span><span class="co">## [2,]    0   20   35    5</span></span>
<span><span class="co">## [3,]   25   15    0    2</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Community weights</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>A set of communities is built.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">communities</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/species_distribution.html">as_abundances</a></span><span class="op">(</span><span class="va">abd</span>, weights <span class="op">=</span> <span class="va">w</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 6</span></span></span>
<span><span class="co">##   site   weight  sp_1  sp_2  sp_3  sp_4</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> site_1      1    10    10    10    10</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> site_2      2     0    20    35     5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> site_3      1    25    15     0     2</span></span></code></pre>
<p>The function <code><a href="../reference/metacommunity.html">metacommunity()</a></code> creates a metacommunity. To
plot it, use argument <code>type = "Metacommunity</code> when plotting
the <code>species_distribution</code>.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metacommunity.html">metacommunity</a></span><span class="op">(</span><span class="va">communities</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##   site          weight  sp_1  sp_2  sp_3  sp_4</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> metacommunity      4  24.6  45.7  56.2  15.5</span></span></code></pre>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">communities</span>, type <span class="op">=</span> <span class="st">"Metacommunity"</span><span class="op">)</span></span></code></pre></div>
<p><img src="divent_files/figure-html/MetaCommunityMC-1.png" width="700"></p>
<p>Each shade of grey represents a species. Heights correspond to the
probability of species and the width of each community is its
weight.</p>
</div>
<div class="section level3">
<h3 id="diversity-estimation-1">Diversity estimation<a class="anchor" aria-label="anchor" href="#diversity-estimation-1"></a>
</h3>
<p>High level functions allow computing diversity of all communities
(<span class="math inline">\(\alpha\)</span> diversity), of the
meta-community (<span class="math inline">\(\gamma\)</span> diversity),
and <span class="math inline">\(\beta\)</span> diversity, i.e. the
number of effective communities (the number of communities with equal
weights and no common species that would yield the observed <span class="math inline">\(\beta\)</span> diversity).</p>
<p>The <code>div_part</code> function calculates everything at once, for
a given order of diversity <span class="math inline">\(q\)</span>:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/div_part.html">div_part</a></span><span class="op">(</span><span class="va">paracou_6_abd</span>, q <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 7 × 6</span></span></span>
<span><span class="co">##   site          scale     estimator order diversity weight</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Metacommunity gamma     <span style="color: #949494;">"</span>UnveilJ<span style="color: #949494;">"</span>     1    111.     6.25</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Metacommunity beta      <span style="color: #949494;">""</span>            1      1.09  <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Metacommunity alpha     <span style="color: #949494;">""</span>            1    102.    <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> subplot_1     community <span style="color: #949494;">"</span>UnveilJ<span style="color: #949494;">"</span>     1     96.3    1.56</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> subplot_2     community <span style="color: #949494;">"</span>UnveilJ<span style="color: #949494;">"</span>     1    113.     1.56</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> subplot_3     community <span style="color: #949494;">"</span>UnveilJ<span style="color: #949494;">"</span>     1    105.     1.56</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span> subplot_4     community <span style="color: #949494;">"</span>UnveilJ<span style="color: #949494;">"</span>     1     94.6    1.56</span></span></code></pre>
<p>An alternative is the <code>gamma</code> argument of all diversity
estimation function to obtain <span class="math inline">\(\gamma\)</span> diversity instead of the diversity
of each community.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">paracou_6_abd</span>, q <span class="op">=</span> <span class="fl">1</span>, gamma <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##   site          estimator order diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Metacommunity UnveilJ       1      111.</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="full-documentation">Full documentation<a class="anchor" aria-label="anchor" href="#full-documentation"></a>
</h2>
<p><a href="https://ericmarcon.github.io/divent/" class="uri">https://ericmarcon.github.io/divent/</a></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Cao2014" class="csl-entry">
Cao, Lijuan, and Michael Grabchak. 2014.
<em><span>EntropyEstimation</span>: <span>Estimation</span> of Entropy
and Related Quantities</em>. R Package.
</div>
<div id="ref-Chao2014" class="csl-entry">
Chao, Anne, Nicholas J. Gotelli, T. C. Hsieh, Elizabeth L. Sander, K. H.
Ma, Robert K. Colwell, and Aaron M. Ellison. 2014. <span>“Rarefaction
and Extrapolation with <span>Hill</span> Numbers: <span>A</span>
Framework for Sampling and Estimation in Species Diversity
Studies.”</span> <em>Ecological Monographs</em> 84 (1): 45–67. <a href="https://doi.org/10.1890/13-0133.1" class="external-link">https://doi.org/10.1890/13-0133.1</a>.
</div>
<div id="ref-Chao2015" class="csl-entry">
Chao, Anne, and Lou Jost. 2015. <span>“Estimating Diversity and Entropy
Profiles via Discovery Rates of New Species.”</span> <em>Methods in
Ecology and Evolution</em> 6 (8): 873–82. <a href="https://doi.org/10.1111/2041-210X.12349" class="external-link">https://doi.org/10.1111/2041-210X.12349</a>.
</div>
<div id="ref-Chao2003" class="csl-entry">
Chao, Anne, and Tsung-Jen Shen. 2003. <span>“Nonparametric Estimation of
<span>Shannon</span>’s Index of Diversity When There Are Unseen Species
in Sample.”</span> <em>Environmental and Ecological Statistics</em> 10
(4): 429–43. <a href="https://doi.org/10.1023/A:1026096204727" class="external-link">https://doi.org/10.1023/A:1026096204727</a>.
</div>
<div id="ref-Grassberger1988" class="csl-entry">
Grassberger, Peter. 1988. <span>“Finite Sample Corrections to Entropy
and Dimension Estimates.”</span> <em>Physics Letters A</em> 128 (6-7):
369–73. <a href="https://doi.org/10.1016/0375-9601(88)90193-4" class="external-link">https://doi.org/10.1016/0375-9601(88)90193-4</a>.
</div>
<div id="ref-Hill1973" class="csl-entry">
Hill, M. O. 1973. <span>“Diversity and Evenness: <span>A</span> Unifying
Notation and Its Consequences.”</span> <em>Ecology</em> 54 (2): 427–32.
<a href="https://doi.org/10.2307/1934352" class="external-link">https://doi.org/10.2307/1934352</a>.
</div>
<div id="ref-Jost2006" class="csl-entry">
Jost, Lou. 2006. <span>“Entropy and Diversity.”</span> <em>Oikos</em>
113 (2): 363–75. <a href="https://doi.org/10.1111/j.2006.0030-1299.14714.x" class="external-link">https://doi.org/10.1111/j.2006.0030-1299.14714.x</a>.
</div>
<div id="ref-Leinster2012" class="csl-entry">
Leinster, Tom, and Christina Cobbold. 2012. <span>“Measuring Diversity:
The Importance of Species Similarity.”</span> <em>Ecology</em> 93 (3):
477–89. <a href="https://doi.org/10.1890/10-2402.1" class="external-link">https://doi.org/10.1890/10-2402.1</a>.
</div>
<div id="ref-Marcon2015a" class="csl-entry">
Marcon, Eric. 2015. <span>“Practical Estimation of Diversity from
Abundance Data.”</span> <em>HAL</em> 01212435 (version 2).
</div>
<div id="ref-Marcon2014b" class="csl-entry">
Marcon, Eric, and Bruno Hérault. 2015. <span>“Decomposing
Phylodiversity.”</span> <em>Methods in Ecology and Evolution</em> 6 (3):
333–39. <a href="https://doi.org/10.1111/2041-210X.12323" class="external-link">https://doi.org/10.1111/2041-210X.12323</a>.
</div>
<div id="ref-Marcon2014a" class="csl-entry">
Marcon, Eric, Ivan Scotti, Bruno Hérault, Vivien Rossi, and Gabriel
Lang. 2014. <span>“Generalization of the Partitioning of
<span>Shannon</span> Diversity.”</span> <em>Plos One</em> 9 (3): e90289.
<a href="https://doi.org/10.1371/journal.pone.0090289" class="external-link">https://doi.org/10.1371/journal.pone.0090289</a>.
</div>
<div id="ref-Marcon2014e" class="csl-entry">
Marcon, Eric, Zhiyi Zhang, and Bruno Hérault. 2014. <span>“The
Decomposition of Similarity-Based Diversity and Its Bias
Correction.”</span> <em>HAL</em> 00989454 (version 3).
</div>
<div id="ref-Pavoine2009" class="csl-entry">
Pavoine, Sandrine, and Michael B. Bonsall. 2009. <span>“Biological
Diversity: <span>Distinct</span> Distributions Can Lead to the
Maximization of <span>Rao</span>’s Quadratic Entropy.”</span>
<em>Theoretical Population Biology</em> 75 (2-3): 153–63. <a href="https://doi.org/10.1016/j.tpb.2009.01.008" class="external-link">https://doi.org/10.1016/j.tpb.2009.01.008</a>.
</div>
<div id="ref-Pavoine2005a" class="csl-entry">
Pavoine, Sandrine, Sébastien Ollier, and Anne-Béatrice Dufour. 2005.
<span>“Is the Originality of a Species Measurable?”</span> <em>Ecology
Letters</em> 8: 579–86. <a href="https://doi.org/10.1111/j.1461-0248.2005.00752.x" class="external-link">https://doi.org/10.1111/j.1461-0248.2005.00752.x</a>.
</div>
<div id="ref-Podani2007" class="csl-entry">
Podani, János, and Dénes Schmera. 2007. <span>“How Should a
Dendrogram-Based Measure of Functional Diversity Function?
<span>A</span> Rejoinder to <span>Petchey</span> and
<span>Gaston</span>.”</span> <em>Oikos</em> 116 (8): 1427–30. <a href="https://doi.org/10.1111/j.2007.0030-1299.16160.x" class="external-link">https://doi.org/10.1111/j.2007.0030-1299.16160.x</a>.
</div>
<div id="ref-Preston1948" class="csl-entry">
Preston, F. W. 1948. <span>“The Commonness, and Rarity, of
Species.”</span> <em>Ecology</em> 29 (3): 254–83. <a href="https://doi.org/10.2307/1930989" class="external-link">https://doi.org/10.2307/1930989</a>.
</div>
<div id="ref-Tsallis1988" class="csl-entry">
Tsallis, Constantino. 1988. <span>“Possible Generalization of
Boltzmann-Gibbs Statistics.”</span> <em>Journal of Statistical
Physics</em> 52 (1): 479–87. <a href="https://doi.org/10.1007/BF01016429" class="external-link">https://doi.org/10.1007/BF01016429</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Marcon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
