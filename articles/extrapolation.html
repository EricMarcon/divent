<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Asymptotic Estimation, Interpolation and Extrapolation  • divent</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Asymptotic Estimation, Interpolation and Extrapolation ">
<meta property="og:description" content="divent">
<meta property="og:image" content="https://ericmarcon.github.io/entropart/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">divent</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/divent.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/arguments.html">Common Arguments of divent Functions</a>
    </li>
    <li>
      <a href="../articles/extrapolation.html">Asymptotic Estimation, Interpolation and Extrapolation </a>
    </li>
    <li>
      <a href="../articles/phylogenies.html">Phylogenies in divent</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/EricMarcon/divent/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Asymptotic Estimation, Interpolation and
Extrapolation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EricMarcon/divent/blob/HEAD/vignettes/articles/extrapolation.Rmd" class="external-link"><code>vignettes/articles/extrapolation.Rmd</code></a></small>
      <div class="hidden name"><code>extrapolation.Rmd</code></div>

    </div>

    
    
<p>Estimation of diversity in <em>divent</em> relies on classical
assumptions that are recalled here. The observed data is a sample of a
community (or several communities if data is a metacommunity). All
“reduced-bias estimator” are asymptotic estimators of the community
diversity: if the sample size could be extended infinitely, diversity
would tend to the diversity of the whole (asymptotic) community. In
hyperdiverse ecosystems such as evergreen forests, the asymptotic
community generally does not exist in the field because of environmental
variations: increasing the size of the sample results in sampling in
different communities. Thus, the asymptotic estimators of diversity
correspond to theoretical asymptotic communities that do not necessarily
exist. In other words, the asymptotic diversity is that of a community
that would provide the observed sample.</p>
<p>Diversity is accumulated as a function of sample size. HCDT (aka
Tsallis) entropy (thus Hill numbers and phylodiversity) can be estimated
at any sample size <span class="citation">(Chao et al. 2014)</span>, by
interpolation down from the actual sample size and by extrapolation up
to infinite sample size, i.e. the asymptotic estimator. Alternatively,
sample size may be replaced by sample coverage, by interpolation from
arbitrary small sample coverages to that of the actual sample, and by
extrapolation up to the asymptotic estimator whose sample coverage is
1.</p>
<div class="section level2">
<h2 id="asymptotic-estimation">Asymptotic estimation<a class="anchor" aria-label="anchor" href="#asymptotic-estimation"></a>
</h2>
<p>If community data is a vector of probabilities, sample size is
unknown so the only available estimation is that of the actual
sample.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ericmarcon.github.io/divent" class="external-link">"divent"</a></span><span class="op">)</span></span>
<span><span class="co"># Paracou plot 6, subplot 1:</span></span>
<span><span class="co"># 1,5 ha of tropical forest, distribution of probabilities</span></span>
<span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/species_distribution.html">as_probabilities</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> </span>
<span>  <span class="va">prob_paracou6_1</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 337</span></span></span>
<span><span class="co">##   site      weight Abarema_jupunba Abarema_mataybifolia Amaioua_guianensis</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56         0.002<span style="text-decoration: underline;">12</span>              0.002<span style="text-decoration: underline;">12</span>            0.001<span style="text-decoration: underline;">06</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 332 more variables: Amanoa_congesta &lt;dbl&gt;, Amanoa_guianensis &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Ambelania_acida &lt;dbl&gt;, Amphirrhox_longifolia &lt;dbl&gt;, Andira_coriacea &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Apeiba_glabra &lt;dbl&gt;, Aspidosperma_album &lt;dbl&gt;, Aspidosperma_cruentum &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Aspidosperma_excelsum &lt;dbl&gt;, Bocoa_prouacensis &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Brosimum_guianense &lt;dbl&gt;, Brosimum_rubescens &lt;dbl&gt;, Brosimum_utile &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Carapa_surinamensis &lt;dbl&gt;, Caryocar_glabrum &lt;dbl&gt;, Casearia_decandra &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Casearia_javitensis &lt;dbl&gt;, Catostemma_fragrans &lt;dbl&gt;, …</span></span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Diversity of order 1, no reduced-bias estimator available.</span></span>
<span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">prob_paracou6_1</span>, q <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##   site      weight estimator order diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 naive         1      77.0</span></span></code></pre>
<p>Further estimation requires abundances, i.e. the number of
individuals per species. Then, the default estimator is the asymptotic
one.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Diversity of order 1, default asymptotic estimator used.</span></span>
<span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, q <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##   site      weight estimator order diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 UnveilJ       1      96.3</span></span></code></pre>
<p>Several asymptotic estimators are available in the literature and
implemented in <em>divent</em>. For consistency, <em>divent</em> uses
the jackknife estimator of richness and the unveiled jackknife estimator
for entropy. The advantage of these estimators is that they provide
reliable estimations even though the sampling effort is low: then, the
estimation variance increases but its bias remains acceptable because
the order of the jackknife estimator is chosen according to the data.
Poorly-sampled communities are estimated by a higher-order jackknife,
resulting in higher estimation variance.</p>
<p>For well-sampled communities, i.e. in the domain of validity of the
jacknife of order 1, the Chao1 estimator of richness and the Chao-Jost
estimator of entropy are the best choices because they have the best
mathematical support, but they will severely underestimate the diversity
of poorly-sampled communities. They also are more
computer-intensive.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimation of richness relies on jackknife 3 (poor sampling)</span></span>
<span><span class="fu"><a href="../reference/div_richness.html">div_richness</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##   site      weight estimator   order diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 Jackknife 3     0       355</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Richness is underestimated by the Chao1 estimator</span></span>
<span><span class="fu"><a href="../reference/div_richness.html">div_richness</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, estimator <span class="op">=</span> <span class="st">"Chao1"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##   site      weight estimator order diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 Chao1         0      290.</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Diversity of order 1 underestimated by the Chao-Jost estimator</span></span>
<span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, q <span class="op">=</span> <span class="fl">1</span>, estimator <span class="op">=</span> <span class="st">"ChaoJost"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##   site      weight estimator order diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 ChaoJost      1      91.3</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="choosing-the-estimation-level">Choosing the estimation level<a class="anchor" aria-label="anchor" href="#choosing-the-estimation-level"></a>
</h2>
<p>Asymptotic estimation is not always the best choice, for example when
comparing the diversity of poorly-sampled communities: a lower sample
coverage can be chosen to limit the uncertainty of estimation.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Actual sample coverage</span></span>
<span><span class="fu"><a href="../reference/coverage.html">coverage</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##   site      weight estimator  coverage</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 ZhangHuang    0.911</span></span></code></pre>
<p>The estimation level may be a sample size or a sample coverage that
is converted internally into a sample size.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Diversity at half the sample size (interpolated)</span></span>
<span><span class="va">paracou6_1_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/abd_species.html">abd_sum</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, as_numeric <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, q <span class="op">=</span> <span class="fl">1</span>, level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">paracou6_1_size</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##   site      weight estimator     order level diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 Interpolation     1   471      67.6</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample size corresponding to 90% coverage</span></span>
<span><span class="fu"><a href="../reference/coverage.html">coverage_to_size</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, sample_coverage <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##   site      weight sample_coverage  size</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56             0.9   819</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Diversity at 90% sample coverage</span></span>
<span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, q <span class="op">=</span> <span class="fl">1</span>, level <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##   site      weight estimator     order level diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 Interpolation     1   819      75.4</span></span></code></pre>
<p>If the sample size is smaller than the actual sample, entropy is
interpolated.</p>
<p>If it is higher, entropy must be extrapolated. For diversity orders
equal to 0 (richness), 1 (Shannon) or 2 (Simpson), explicit, almost
unbiased estimators are used. Continuity of the estimation of diversity
around the actual sample size is guaranteed.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simpson diversity at levels from 0.9 to 1.1 times the sample size</span></span>
<span><span class="fu"><a href="../reference/accum_hill.html">accum_hill</a></span><span class="op">(</span></span>
<span>  <span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>,</span>
<span>  q <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">0.9</span> <span class="op">*</span> <span class="va">paracou6_1_size</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">1.1</span> <span class="op">*</span> <span class="va">paracou6_1_size</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="extrapolation_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>For non-integer orders, things get more complicated. In
<em>divent</em>, asymptotic entropy is estimated by the unveiled
jackknife estimator and rarefied down to the actual sample size. There
is no reason for it to correspond exactly to the observed entropy. The
asymptotic richness is the less robust part of the estimation thus it is
adjusted iteratively until the rarefied entropy equals the actual
sample’s entropy, ensuring continuity between interpolation and
extrapolation.</p>
<p>The default arguments of all functions apply this strategy, except
for Simpson’s diversity (<span class="math inline">\(q=2\)</span>) that
is estimated directly without bias.</p>
</div>
<div class="section level2">
<h2 id="diversity-accumulation">Diversity accumulation<a class="anchor" aria-label="anchor" href="#diversity-accumulation"></a>
</h2>
<p>Diversity Accumulation Curves (DAC) are a generalization of the
well-known Species Accumulation Curves (SAC). They represent diversity
as a function of sample size.</p>
<p>The <code><a href="../reference/accum_hill.html">accum_hill()</a></code> function allows to build them. A
bootstrap confidence interval can be calculated around the estimated DAC
by simulating random multinomial draws of the asymptotic distribution at
each sample size.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Diversity at levels from 1 to twice the sample size</span></span>
<span><span class="fu"><a href="../reference/accum_hill.html">accum_hill</a></span><span class="op">(</span></span>
<span>  <span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, </span>
<span>  q <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">1.1</span> <span class="op">*</span> <span class="va">paracou6_1_size</span><span class="op">)</span>, </span>
<span>  n_simulations <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="extrapolation_files/figure-html/accum_hill-1.png" width="700"></p>
<p>To ensure continuity of the DAC around the actual sample, the
asymptotic diversity is estimated by unveiling the asymptotic
distribution, choosing the number of species such that the rarefied
diversity at the observed sample size is the observed diversity. This
means that the extrapolated diversity at a high sample coverage will
differ from the best asymptotic estimation, sometimes quite much if
sampling level is poor.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extrapolation at 99.99% sample coverage</span></span>
<span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, q <span class="op">=</span> <span class="fl">1</span>, level<span class="op">=</span><span class="fl">0.9999</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##   site      weight estimator order level diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 Chao2015      1  <span style="text-decoration: underline;">8</span>615      94.0</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Unveiled Jaccknife asymptotic estimator</span></span>
<span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, q <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##   site      weight estimator order diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 UnveilJ       1      96.3</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Chao-Jost estimator</span></span>
<span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, q <span class="op">=</span> <span class="fl">1</span>, Correction<span class="op">=</span><span class="st">"ChaoJost"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##   site      weight estimator order diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> subplot_1   1.56 UnveilJ       1      96.3</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="diversity-profiles-at-a-sampling-level">Diversity profiles at a sampling level<a class="anchor" aria-label="anchor" href="#diversity-profiles-at-a-sampling-level"></a>
</h2>
<p>Diversity profiles are usually asymptotic but they can be calculated
at any coverage of sampling level.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Diversity at levels from 1 to twice the sample size</span></span>
<span><span class="fu"><a href="../reference/profile_hill.html">profile_hill</a></span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, level <span class="op">=</span> <span class="va">paracou6_1_size</span> <span class="op">*</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="extrapolation_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Extrapolated diversity is estimated at each order such that it is
continuous at the observed sample size.</p>
</div>
<div class="section level2">
<h2 id="differences-with-the-inext-package">Differences with the iNEXT package<a class="anchor" aria-label="anchor" href="#differences-with-the-inext-package"></a>
</h2>
<p><em>iNEXT</em> <span class="citation">(Hsieh, Ma, and Chao
2016)</span> is designed primarily to interpolate or extrapolate
diversity of integer orders. Extrapolation of diversity of order 0
relies on the Chao1 estimator of richness and that of order 1 uses the
Chao-Jost estimator. In <em>divent</em>, extrapolation relies on the
estimation of the asymptotic distribution of the community with
asymptotic richness such that the entropy of the asymptotic distribution
rarefied to the observed sample size equals the observed entropy of the
data. This approach allows consistent estimation of extrapolated
diversity at integer and non-integer orders, thus allowing consistent
diversity profiles without discontinuities at <span class="math inline">\(q=0\)</span> and <span class="math inline">\(q=1\)</span>. The results of <em>iNEXT</em> can be
obtained by forcing argument <code>estimator = "ChaoJost"</code>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://chao.stat.nthu.edu.tw/wordpress/software_download/" class="external-link">"iNEXT"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">spider</span><span class="op">)</span></span>
<span><span class="co"># Extrapolated diversity of an example dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/iNEXT/man/estimateD.html" class="external-link">estimateD</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">Girdled</span>, level<span class="op">=</span><span class="fl">300</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Assemblage   m        Method Order.q        SC        qD    qD.LCL    qD.UCL</span></span>
<span><span class="co">## 1       data 300 Extrapolation       0 0.9579518 33.317733 25.804082 40.831384</span></span>
<span><span class="co">## 2       data 300 Extrapolation       1 0.9579518 12.869603 10.314593 15.424612</span></span>
<span><span class="co">## 3       data 300 Extrapolation       2 0.9579518  7.983882  5.993923  9.973841</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Similar estimation by divent</span></span>
<span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">Girdled</span>, q <span class="op">=</span> <span class="fl">0</span>, level <span class="op">=</span> <span class="fl">300</span>, estimator <span class="op">=</span> <span class="st">"ChaoJost"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##   estimator order level diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> jackknife     0   300      33.5</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">Girdled</span>, q <span class="op">=</span> <span class="fl">1</span>, level <span class="op">=</span> <span class="fl">300</span>, estimator <span class="op">=</span> <span class="st">"ChaoJost"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##   estimator order level diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Chao2015      1   300      13.1</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimation at order 2 is explicit, with no optional choice</span></span>
<span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">Girdled</span>, q <span class="op">=</span> <span class="fl">2</span>, level <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##   estimator order level diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Chao2014      2   300      7.98</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Default estimation of divent</span></span>
<span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">Girdled</span>, q <span class="op">=</span> <span class="fl">0</span>, level <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##   estimator order level diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> jackknife     0   300      33.5</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/div_hill.html">div_hill</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">Girdled</span>, q <span class="op">=</span> <span class="fl">1</span>, level <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">##   estimator order level diversity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Chao2015      1   300      13.1</span></span></code></pre>
<p>Small differences are due to different estimators of sample coverage:
<em>divent</em> uses the more accurate <code>ZhangHuang</code> estimator
by default.</p>
<p>Last, confidence intervals of diversity accumulation assume normality
in <em>iNEXT</em>: estimation variance is estimated by bootstrap and the
confidence interval is defined as <span class="math inline">\(\pm
1.96\)</span> times the standard deviation. In <em>divent</em>,
confidence intervals are built directly from the quantiles of
bootstrapped estimations.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Chao2014" class="csl-entry">
Chao, Anne, Nicholas J. Gotelli, T. C. Hsieh, Elizabeth L. Sander, K. H.
Ma, Robert K. Colwell, and Aaron M. Ellison. 2014. <span>“Rarefaction
and Extrapolation with <span>Hill</span> Numbers: <span>A</span>
Framework for Sampling and Estimation in Species Diversity
Studies.”</span> <em>Ecological Monographs</em> 84 (1): 45–67. <a href="https://doi.org/10.1890/13-0133.1" class="external-link">https://doi.org/10.1890/13-0133.1</a>.
</div>
<div id="ref-Hsieh2014" class="csl-entry">
Hsieh, T. C., K. H. Ma, and Anne Chao. 2016. <span>“<span class="nocase">iNEXT</span>: <span>An R</span> Package for Interpolation
and Extrapolation in Measuring Species Diversity.”</span> <em>Methods in
Ecology and Evolution</em> 7: 1451–56. <a href="https://doi.org/10.1111/2041-210X.12613" class="external-link">https://doi.org/10.1111/2041-210X.12613</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Eric Marcon.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
