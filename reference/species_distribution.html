<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Species Distributions — species_distribution • divent</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Species Distributions — species_distribution"><meta property="og:description" content="A Species Distribution is a tibble::tibble containing species abundances or probabilities."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">divent</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1-0.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/EricMarcon/divent/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Species Distributions</h1>
    <small class="dont-index">Source: <a href="https://github.com/EricMarcon/divent/blob/HEAD/R/species_distribution.R" class="external-link"><code>R/species_distribution.R</code></a></small>
    <div class="hidden name"><code>species_distribution.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A Species Distribution is a <a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble::tibble</a> containing species abundances or probabilities.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">species_distribution</span><span class="op">(</span><span class="va">x</span>, names <span class="op">=</span> <span class="cn">NULL</span>, weights <span class="op">=</span> <span class="cn">NULL</span>, check_arguments <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">as_species_distribution</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for numeric</span></span>
<span><span class="fu">as_species_distribution</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, check_arguments <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for matrix</span></span>
<span><span class="fu">as_species_distribution</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, check_arguments <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for data.frame</span></span>
<span><span class="fu">as_species_distribution</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, check_arguments <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">is_species_distribution</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">probabilities</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  estimator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"naive"</span>, <span class="st">"Chao2013"</span>, <span class="st">"Chao2015"</span>, <span class="st">"ChaoShen"</span><span class="op">)</span>,</span>
<span>  unveiling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"uniform"</span>, <span class="st">"geometric"</span><span class="op">)</span>,</span>
<span>  richness_estimator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"jackknife"</span>, <span class="st">"iChao1"</span>, <span class="st">"Chao1"</span>, <span class="st">"rarefy"</span>, <span class="st">"naive"</span><span class="op">)</span>,</span>
<span>  jack_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  coverage_estimator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ZhangHuang"</span>, <span class="st">"Chao"</span>, <span class="st">"Turing"</span>, <span class="st">"Good"</span><span class="op">)</span>,</span>
<span>  q <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  check_arguments <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">as_probabilities</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for numeric</span></span>
<span><span class="fu">as_probabilities</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, check_arguments <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for matrix</span></span>
<span><span class="fu">as_probabilities</span><span class="op">(</span><span class="va">x</span>, names <span class="op">=</span> <span class="cn">NULL</span>, weights <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span>, check_arguments <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">is_probabilities</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">abundances</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  round <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  check_arguments <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">as_abundances</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for numeric</span></span>
<span><span class="fu">as_abundances</span><span class="op">(</span><span class="va">x</span>, round <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span>, check_arguments <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for integer</span></span>
<span><span class="fu">as_abundances</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, check_arguments <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for matrix</span></span>
<span><span class="fu">as_abundances</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  round <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  check_arguments <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">is_abundances</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>An object.</p></dd>


<dt>names</dt>
<dd><p>The names of the species distributions.</p></dd>


<dt>weights</dt>
<dd><p>The weights of the sites of the species distributions.</p></dd>


<dt>check_arguments</dt>
<dd><p>If <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed to <a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a>. Unused elsewhere.</p></dd>


<dt>estimator</dt>
<dd><p>One of the estimators of a probability distribution:
"naive" (the default value), or "Chao2013", "Chao2015", "ChaoShen" to estimate
the probabilities of the observed species in the asymptotic distribution.</p></dd>


<dt>unveiling</dt>
<dd><p>One of the possible unveiling methods to estimate the probabilities
of the unobserved species: "none" (default, no species is added), "uniform"
(all unobserved species have the same probability) or "geometric" (the
unobserved species distribution is geometric).</p></dd>


<dt>richness_estimator</dt>
<dd><p>An estimator of richness to evaluate the total number
of species. "jackknife" is the default value.
An alternative is "rarefy" to estimate the number of species such that the
entropy of the asymptotic distribution rarefied to the observed sample size equals
the actual entropy of the data.</p></dd>


<dt>jack_max</dt>
<dd><p>The highest jackknife order allowed. Default is 10.
Allowed values are between 1 and 10.</p></dd>


<dt>coverage_estimator</dt>
<dd><p>An estimator of sample coverage used by <a href="sample_coverage.html">coverage</a>:
"ZhangHuang" (the default value), <code>"Chao"</code>, <code>"Turing"</code> or <code>"Good"</code>.</p></dd>


<dt>q</dt>
<dd><p>The order of diversity. Default is 0 for richness.
Used only to estimate asymptotic probability distributions when argument
<code>richness_estimator</code> is "rarefy". Then, the number of unobserved species is
fitted so that the entropy of order q of the asymptotic probability distribution
at the observed sample size equals the actual entropy of the data.</p></dd>


<dt>round</dt>
<dd><p>If <code>TRUE</code>, the values of <code>x</code> are converted to integers.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><code>species_distribution</code> objects include <code>abundances</code> and <code>probabilities</code> objects.</p>
<p><code>as_abundances()</code> formats the numeric or integer <code>x</code> so that appropriate versions of community functions (generic methods such as Diversity) are applied. Abundance values are rounded (by default) to the nearest integer.</p>
<p><code>as_probabilities()</code> normalizes the vector <code>x</code> so that it sums to 1.
If the <code>estimator</code> is not "naive", the observed abundance distribution is used
to estimate the actual species distribution. The list of species will be changed:
zero-abundance species will be cleared, and some unobserved species will be added.
First, observed species probabilities are estimated following
Chao and Shen (2003)
, i.e. input probabilities are multiplied by
the sample coverage, or according to more sophisticated models:
Chao et al. (2013)
, a single-parameter model, or
Chao and Jost (2015)
, a two-parameter model.
The total probability of observed species equals the sample coverage.
Then, the distribution of unobserved species can be unveiled: their number
is estimated according to the <code>richness_estimator</code>.
The coverage deficit (1 minus the sample coverage) is shared by the unobserved
species equally (<code>unveiling</code> = "uniform", (Chao et al. 2013)
) or
according to a geometric distribution (<code>unveiling</code> = "geometric", (Chao and Jost 2015)
).</p>
<p>TODO: These functions can be applied to data frames to calculate the joint diversity (Gregorius 2010)
.</p>
<p><code>species_distribution</code> objects objects can be plotted by <code>plot</code> and <code>autoplot()</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Chao A, Jost L (2015).
“Estimating Diversity and Entropy Profiles via Discovery Rates of New Species.”
<em>Methods in Ecology and Evolution</em>, <b>6</b>(8), 873--882.
<a href="https://doi.org/10.1111/2041-210X.12349" class="external-link">doi:10.1111/2041-210X.12349</a>
.<br><br> Chao A, Shen T (2003).
“Nonparametric Estimation of Shannon's Index of Diversity When There Are Unseen Species in Sample.”
<em>Environmental and Ecological Statistics</em>, <b>10</b>(4), 429--443.
<a href="https://doi.org/10.1023/A%3A1026096204727" class="external-link">doi:10.1023/A:1026096204727</a>
.<br><br> Chao A, Wang Y, Jost L (2013).
“Entropy and the Species Accumulation Curve: A Novel Entropy Estimator via Discovery Rates of New Species.”
<em>Methods in Ecology and Evolution</em>, <b>4</b>(11), 1091--1100.
<a href="https://doi.org/10.1111/2041-210x.12108" class="external-link">doi:10.1111/2041-210x.12108</a>
.<br><br> Gregorius H (2010).
“Linking Diversity and Differentiation.”
<em>Diversity</em>, <b>2</b>(3), 370--394.
<a href="https://doi.org/10.3390/d2030370" class="external-link">doi:10.3390/d2030370</a>
.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Paracou data</span></span></span>
<span class="r-in"><span><span class="fu">is_species_distribution</span><span class="op">(</span><span class="va">paracou_6_abd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="co"># Whittaker plot fitted by a log-normal distribution TODO</span></span></span>
<span class="r-in"><span><span class="co"># autoplot(asm_paracou_6, distribution = "lognormal")</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Eric Marcon, Bruno Herault.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

